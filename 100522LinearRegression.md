### Linear Regression Exercise

#### 1. Plot the relationship between age and wing length. 

```
Age = [3;4;5;6;7;8;9;11;12;14;15;16;17];
WingLength = [1.4;1.5;2.2;2.4;3.1;3.2;3.2;3.9;4.1;4.7;4.5;5.2;5];

scatter(Age,WingLength);
title('Plot of Age vs. Wing Length');
xlabel('Age (years)');
ylabel('Wing Length (cm)');
```


![PSet8](https://user-images.githubusercontent.com/112706184/193486721-14af907b-bd9c-4f05-9fc3-45b6297ca0f3.jpg)

#### 2. Calculate and plot the regression line. 

##### Calculate slope:

```
Term1 = 0;
for i = 1:13
    Term1 = Term1 + (Age(i)*WingLength(i));
end


SumAge = 0;
SumWingLength = 0;
for i = 1:13
    SumAge = SumAge + Age(i);
    SumWingLength = SumWingLength + WingLength(i);
end

n = 13;
Term2 = (SumAge * SumWingLength)/n;

Numerator = Term1-Term2;

Term3 = 0;
for i = 1:13
    Term3 = Term3 + ((Age(i))^2);
end

Term4 = ((SumAge)^2)/n;

Denominator = Term3 - Term4;

b = Numerator/Denominator;

fprintf('This yields a slope of b = %f.\n',b)
```
This yields a slope of b = 0.264684.

##### Calculate intercept:

```
WingLengthAvg = mean(WingLength);
AgeAvg = mean(Age);
a = WingLengthAvg - b*AgeAvg;
fprintf('This yields an intercept of a = %f.\n',a)
```
This yields an intercept of a = 0.829624.

I checked these results using the function fitlm and it yielded the same numbers. 

```
fitlm(Age,WingLength,"linear");
```


##### Plot line: 

```
scatter(Age,WingLength);
title('Plot of Age vs. Wing Length');
xlabel('Age (years)');
ylabel('Wing Length (cm)');
hold on
refline(b,a);
```

Yields the following graph: 

![PSet8](https://user-images.githubusercontent.com/112706184/193488198-d64045cc-d959-4be6-9000-2389678c13a8.jpg)

#### 3. Can you reject H0: b = 0? 
Use fitlm function to compute standard error of the slope b: 

```
LinReg = fitlm(Age,WingLength,"linear");
SEb = LinReg.Coefficients{2,2}; %call standard error of the slope from this analysis
t = b/SEb; %find value in t distribution corresponding to the slope and its standard error
df = n - 2;
p = tcdf(t,df,"upper")*2; %use T distribution CDF to compute 2-tailed p-value. 
fprintf('p = %d.\n',p)
```
p = 3.009743e-09.

Based on this p value, we can reject the null hypothesis that b = 0. 

#### 4. Calculate and plot confidence intervals on the slope of the regression. 

Use formula from tutorial to compute 95% CI: 

```
Denom = 0;
for i = 1:13
    Denom = Denom + ((Age(i) - AgeAvg)^2);
end
CI95Upper = b + tinv(0.975,n-2) * sqrt((LinReg.MSE)/Denom);
CI95Lower = b + tinv(0.025,n-2) * sqrt((LinReg.MSE)/Denom);
fprintf('95%% CI [%f,%f].\n',CI95Lower,CI95Upper)
```

This yields: 95% CI [0.230439,0.298929].

To plot this confidence interval on the regression slope, we need to compute 95% CI of wing length at each theoretical value of age in a range including our data. We hold on the graph generated by the previous code above and superimpose the confidence intervals on the slope. 

```
AgeTheoretical = [2:0.1:18]';
WingLength95Upper = AgeTheoretical*CI95Upper + a;
WingLength95Lower = AgeTheoretical*CI95Lower + a;
hold on
coord_up = [AgeTheoretical,WingLength95Upper];
coord_low = [AgeTheoretical,WingLength95Lower];
coord_combine = [coord_up;flipud(coord_low)];
fill(coord_combine(:,1),coord_combine(:,2),'b','FaceAlpha',0.25)
```

This generates the following plot: 

![pset8ci](https://user-images.githubusercontent.com/112706184/193494106-8f41c1e5-6d4c-44bd-8e15-8e410975fde0.jpg)

#### 5. Calculate r<sup>2</sup> (coefficient of determination)
